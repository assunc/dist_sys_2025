<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="content">
    <div style="max-width: 960px; margin: 0 auto; padding: 24px;">
        <h2>Book a Flight</h2>

        <form th:action="@{/flights}" method="post" style="display: flex; align-items: center; gap: 8px; background-color: white; border: 2px solid #febb02; border-radius: 12px; padding: 12px; max-width: 100%; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
            <!-- FROM -->
            <div style="display: flex; align-items: center; background-color: #f2f2f2; padding: 10px 12px; border-radius: 8px; flex: 1;">
                <i class="fa-solid fa-plane-departure" style="margin-right: 8px; font-size: 18px; color: #555;"></i>
                <input type="text" name="source" placeholder="From" th:value="${source}" style="border: none; background: transparent; outline: none; font-size: 16px; width: 100%;">
            </div>

            <!-- SWAP BUTTON -->
            <button type="button" style="background-color: white; border: 1px solid #ccc; border-radius: 8px; padding: 10px; cursor: pointer;">
                <i class="fa-solid fa-right-left" style="font-size: 18px; color: #555;"></i>
            </button>

            <!-- TO -->
            <div style="display: flex; align-items: center; background-color: #f2f2f2; padding: 10px 12px; border-radius: 8px; flex: 1;">
                <i class="fa-solid fa-location-dot" style="margin-right: 8px; font-size: 18px; color: #555;"></i>
                <input type="text" name="destination" th:value="${destination}" placeholder="To" style="border: none; background: transparent; outline: none; font-size: 16px; width: 100%;">
            </div>

            <!-- DATE -->
            <div style="display: flex; align-items: center; background-color: #f2f2f2; padding: 10px 12px; border-radius: 8px; flex: 1;">
                <i class="fa-solid fa-calendar-days" style="margin-right: 8px; font-size: 18px; color: #555;"></i>
                <input type="date" name="departure_date" th:value="${#dates.format(departure_date, 'yyyy-MM-dd')}" required style="border: none; background: white; outline: none; font-size: 16px; border-radius: 6px; padding: 6px; flex: 1;">
            </div>

            <!-- SEARCH BUTTON -->
            <button type="submit" style="padding: 12px 24px; font-size: 16px; background-color: #0071c2; color: white; border: none; border-radius: 8px; cursor: pointer;">
                Search
            </button>
        </form>

        <!-- Flight Results -->
        <h2 class="mt-5">Available Flights:</h2>
        <div th:if="${flights}" class="mt-4" style="padding-bottom: 100px;">
            <div th:if="${error}" class="alert alert-danger" role="alert">
                <p th:text="${errorMsg}"></p>
            </div>
            <div th:each="flight : ${flights}" style="display: flex; justify-content: space-between; align-items: center; padding: 16px; border: 1px solid #ccc; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 6px rgba(0,0,0,0.05); background-color: white;">
                <!-- LEFT section: Timeline and details -->
                <div style="flex: 1.2;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <!-- Departure -->
                        <div style="text-align: left;">
                            <div style="font-weight: bold;" th:text="${#dates.format(flight.departureTime, 'HH:mm')}"></div>
                            <div style="font-size: 13px; color: #555;" th:text="${flight.source}"></div>
                        </div>

                        <!-- Timeline with badge -->
                        <div style="flex: 1; margin: 0 12px; max-width: 300px;">
                            <div style="display: flex; align-items: center; justify-content: center;">
                                <div style="width: 8px; height: 8px; border: 2px solid black; border-radius: 50%; background: white;"></div>
                                <div style="flex: 1; height: 2px; background: black;"></div>
                                <div style="margin: 0 8px; padding: 2px 10px; background: green; color: white; font-size: 12px; border-radius: 6px;">Direct</div>
                                <div style="flex: 1; height: 2px; background: black;"></div>
                                <div style="width: 8px; height: 8px; border: 2px solid black; border-radius: 50%; background: white;"></div>
                            </div>
                            <div style="text-align: center; font-size: 12px; margin-top: 4px;" th:text="${flight.duration}"></div>
                        </div>

                        <!-- Arrival -->
                        <div style="text-align: right;">
                            <div style="font-weight: bold;" th:text="${#dates.format(flight.arrivalTime, 'HH:mm')}"></div>
                            <div style="font-size: 13px; color: #555;" th:text="${flight.destination}"></div>
                        </div>
                    </div>

                    <!-- Plane model -->
                    <div style="font-size: 14px; color: #777;" th:text="'Plane: ' + ${flight.planeModel}"></div>
                </div>

                <!-- RIGHT section: View details -->
                <div style="flex: 0.6; display: flex; justify-content: flex-end;">
                    <a th:href="@{'/flight-info/' + ${flight.flightNumber}}"
                       style="padding: 10px 20px; border: 1px solid #0071c2; color: #0071c2; background: white; text-decoration: none; border-radius: 6px; font-size: 14px;">
                        View details
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
</html>
